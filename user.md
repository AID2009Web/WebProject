# 用户模块API说明文档
### 数据库结构  
|字段|属性|备注|
|---|---|---|
|id|primary key 主键；auto-increment 自增|本表唯一ID。是否要增加偏移量100000|
|user_ID|char[11] 十一位；unique 唯一索引；not null 不为空|十一位手机号。作为登录唯一帐号。|
|pwd|varchar[32]|用哈希值、MD5存密码|
|created_time|datetime[6]||
|update_time|datetime[6]||
|nickname|varchar[30]|用户昵称【可以重复】默认值在后端设置|
|avatar|varchar[100]|头像|
|info|varchar[150]|简介|
|sign|varchar[50]|标签|
|gender|varchar[1]|m(男)f(女)-(-)|
|location|varchar[50]|地区|
|birthday|date|生日|

## 接口说明  
### 1.注册登录接口  
URL: http://127.0.0.1:5000/v1/u  
### 1.1请求方式  
POST  
### 1.2 请求格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|user_id|char|用户ID|
|pwd|char|密码|
请求示例：  
{'user_id':user_id, 'pwd': pwd}  
### 1.3 响应格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|code|int|状态码。默认正常为200，异常见1.4|
|error|char|错误提示|
|user_id|char|用户ID|
|data|{}|返回数据。用token令牌为此会话保持|
响应示例：  
{‘code’: 200 , ‘username’: ‘abc’, ’data’: {‘token’: ‘asdadasd.cvreijvd.dasdadad’} }  
### 1.4 异常码  
|异常码|含义|备注|
|---|---|---|
|10100|请求无内容||
|10101|请求中未提交用户名|见注释|
|10102|请求中未提交密码|见注释|
|10103|请求中未提交验证码|见注释|
|10104|请求中提交用户名格式有误||
|10105|请求中提交验证码过期||
|10106|请求中提交验证码错误||
|10107|入库失败||
|500|服务器异常||
注释：我的方案是在前端拦截10101&10102&10103，等表单完全填好再POST，未填好都是10100  
异常响应示例：  
{'code': 10100, 'error': '请求无内容'}  

### 2. 短信验证接口  
URL: http://127.0.0.1:5000/v1/u/sms
### 2.1 请求方式  
POST
### 2.2 请求格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|phone|char|用户ID|
请求示例：  
{"phone": phone}   
### 2.3 响应格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|code|int|状态码。默认正常为200，异常见2.4|
|error|char|错误提示|
响应示例：  
{'code': 10101, 'error': '请输入手机号'}  
### 2.4 异常码  
|异常码|含义|备注|
|---|---|---|
|10101|请求中未提交用户名||
|10104|请求中提交用户名格式有误||
|500|服务器异常||
异常响应示例：  
{'code': 10101, 'error': '请输入手机号'}  

### 3. 令牌验证接口  
注：前端登录与注册分开时才使用此接口  
URL: http://127.0.0.1:5000/v1/tokens
### 3.1 请求方式  
POST
### 3.2 请求格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|user_id|char|用户ID|
|pwd|char|密码|
请求示例：  
{'user_id':user_id, 'pwd': pwd}  
### 3.3 响应格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|code|int|状态码。默认正常为200，异常见3.4|
|error|char|错误提示|
|user_id|char|用户ID|
|data|{}|token|
响应示例：  
{'code': 10201, 'error': '用户名或密码错误'}  
### 3.4 异常码  
|异常码|含义|备注|
|---|---|---|
|10201|用户名或密码错误|用户名错误|
|10202|用户名或密码错误|密码错误|
|500|服务器异常||
异常响应示例：  
{'code': 10201, 'error': '用户名或密码错误'}  

### 4. 获取用户数据接口  
URL: `http://127.0.0.1:5000/v1/u/<uid>`
### 4.1 请求方式  
GET
### 4.2 请求格式  
4.2.1 直接GET请求，可获得全量数据  
4.2.2 GET请求后添加查询字符串，可局部查询  
`http://127.0.0.1:5000/v1/u/<uid>?nickname=1`
### 4.3 响应格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|code|int|状态码。默认正常为200，异常见4.4|
|error|char|错误提示|
|user_id|char|用户ID|
|data|{}|返回数据。|
响应示例：  
{'code': 200, 'user_id': '123', 'data': {'nickname': 'asd'}}  
### 4.4 异常码  
|异常码|含义|备注|
|---|---|---|
|10108|用户名不存在||
|500|服务器异常||
异常响应示例：  
{'code': 10108, 'error': '用户名不存在'}  

### 5. 修改用户数据接口  
URL: `http://127.0.0.1:5000/v1/u/<uid>`
### 5.1 请求方式  
PUT
### 5.2 请求格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|nickname|char|用户昵称|
|gender|char|性别|
|location|char|地区|
|birthday|date|生日|
|sign|char|标签|
|info|char|个人简介|
该请求需客户端在HTTP header 里添加 token,  格式如下：  
Authorization ： token  
请求示例：  
{'sign': 'xxx', 'info': 'xxxx'}  
### 5.3 响应格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|code|int|状态码。默认正常为200，异常见5.4|
|error|char|错误提示|
|user_id|char|用户ID|
响应示例：  
{'code': 200, 'user_id': '123'}  
### 5.4 异常码  
|异常码|含义|备注|
|---|---|---|
|10100|请求无内容||
|10109|保存失败||
|10110|未登录||
|500|服务器异常||
异常响应示例：  
{'code': 10100 'error': '请求无内容'}  

### 6. 上传头像接口  
URL: `http://127.0.0.1:5000/v1/u/<uid>/avatar`  
存放路径：BASE_DIR/media/avatar  
### 6.1 请求方式  
POST multipart/form-data
### 6.2 请求格式  
表单 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|avatar|char|图片|
该请求需客户端在HTTP header 里添加 token,  格式如下：  
Authorization ： token  
### 6.3 响应格式  
json 具体参数如下：  
|字段|类型|备注|
|---|---|---|
|code|int|状态码。默认正常为200，异常见6.4|
|error|char|错误提示|
|user_id|char|用户ID|
响应示例：  
{'code': 200, 'user_id': '123'}  
### 6.4 异常码  
|异常码|含义|备注|
|---|---|---|
|10100|请求无内容||
|10110|未登录||
|10111|请求方式错误||
|500|服务器异常||
异常响应示例：  
{'code': 10100 'error': '请求无内容'}  

